"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1761],{89787:function(e,t,r){r.d(t,{Z:function(){return l}});var a=r(57437),n=r(2265),i=r(62385),s=r(66209),o=r(24215);function l(e){let{userId:t}=e,[r,l]=(0,n.useState)([]),[c,d]=(0,n.useState)(0),[u,m]=(0,n.useState)(!1),[f,h]=(0,n.useState)(!1),g=(0,n.useRef)(null);(0,n.useEffect)(()=>{if(t){x(),p();let e=setInterval(()=>{p(),u&&x()},3e4);return()=>clearInterval(e)}},[t,u]),(0,n.useEffect)(()=>{let e=e=>{g.current&&!g.current.contains(e.target)&&m(!1)};return u&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[u]);let x=async()=>{h(!0);try{let e=await i.Lz.getNotifications({limit:10});l(e.data.notifications||[]),d(e.data.unreadCount||0)}catch(e){o.cM.apiError("/notifications",e)}finally{h(!1)}},p=async()=>{try{let e=await i.Lz.getUnreadCount();d(e.data.unreadCount||0)}catch(e){}},v=async e=>{try{await i.Lz.markAsRead(e),l(t=>t.map(t=>t._id===e?{...t,isRead:!0,readAt:new Date}:t)),d(e=>Math.max(0,e-1))}catch(e){o.cM.apiError("/notifications/mark-read",e)}},y=async()=>{try{await i.Lz.markAllAsRead(),l(e=>e.map(e=>({...e,isRead:!0,readAt:new Date}))),d(0)}catch(e){o.cM.apiError("/notifications/mark-all-read",e)}},N=async e=>{try{await i.Lz.deleteNotification(e),l(t=>t.filter(t=>t._id!==e));let t=r.find(t=>t._id===e);t&&!t.isRead&&d(e=>Math.max(0,e-1))}catch(e){o.cM.apiError("/notifications/delete",e)}},w=e=>{e.isRead||v(e._id),e.link&&(window.location.href=e.link)};return(0,a.jsxs)("div",{className:"relative",ref:g,children:[(0,a.jsxs)("button",{onClick:()=>{m(!u),u||x()},className:"relative flex h-10 w-10 cursor-pointer items-center justify-center overflow-hidden rounded-lg bg-background-dark text-gray-300 hover:bg-surface transition-colors",children:[(0,a.jsx)("span",{className:"material-symbols-outlined",children:"notifications"}),c>0&&(0,a.jsx)("span",{className:"absolute top-1 right-1 flex h-5 w-5 items-center justify-center rounded-full bg-red-500 text-xs font-bold text-white",children:c>9?"9+":c})]}),u&&(0,a.jsxs)("div",{className:"absolute right-0 top-12 z-50 w-96 rounded-lg bg-surface border border-surface shadow-xl",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between border-b border-surface p-4",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-white",children:"Notifications"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[c>0&&(0,a.jsx)("button",{onClick:y,className:"text-sm text-primary hover:text-yellow-400 transition-colors",children:"Mark all read"}),(0,a.jsx)("button",{onClick:()=>m(!1),className:"text-gray-400 hover:text-white transition-colors",children:(0,a.jsx)("span",{className:"material-symbols-outlined text-xl",children:"close"})})]})]}),(0,a.jsx)("div",{className:"max-h-96 overflow-y-auto",children:f?(0,a.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,a.jsx)("div",{className:"size-6 animate-spin rounded-full border-2 border-primary border-t-transparent"})}):0===r.length?(0,a.jsxs)("div",{className:"p-8 text-center text-gray-400",children:[(0,a.jsx)("span",{className:"material-symbols-outlined text-4xl mb-2",children:"notifications_off"}),(0,a.jsx)("p",{children:"No notifications"})]}):(0,a.jsx)("div",{className:"divide-y divide-surface",children:r.map(e=>(0,a.jsx)("div",{className:"p-4 hover:bg-background-dark transition-colors cursor-pointer ".concat(e.isRead?"":"bg-background-dark/50"),onClick:()=>w(e),children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"flex-shrink-0 mt-1 ".concat(e.isRead?"text-gray-400":"text-primary"),children:(0,a.jsx)("span",{className:"material-symbols-outlined",children:"deposit_approved"===e.type||"withdrawal_approved"===e.type?"check_circle":"deposit_rejected"===e.type||"withdrawal_rejected"===e.type?"cancel":"bet_won"===e.type?"emoji_events":"bonus_awarded"===e.type?"card_giftcard":"support_ticket_replied"===e.type?"support_agent":"notifications"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,a.jsx)("h4",{className:"text-sm font-medium ".concat(e.isRead?"text-gray-300":"text-white"),children:e.title}),!e.isRead&&(0,a.jsx)("span",{className:"flex-shrink-0 size-2 rounded-full bg-primary"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-400 mt-1 line-clamp-2",children:e.message}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:(0,s.o0)(e.createdAt)})]}),(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),N(e._id)},className:"flex-shrink-0 text-gray-500 hover:text-red-400 transition-colors",children:(0,a.jsx)("span",{className:"material-symbols-outlined text-lg",children:"delete"})})]})},e._id))})}),r.length>0&&(0,a.jsx)("div",{className:"border-t border-surface p-3 text-center",children:(0,a.jsx)("a",{href:"/notifications",className:"text-sm text-primary hover:text-yellow-400 transition-colors",children:"View all notifications"})})]})]})}},87300:function(e,t,r){r.d(t,{$8:function(){return i},GJ:function(){return s},My:function(){return o},kS:function(){return l},ts:function(){return a}});let a=()=>{try{let e=localStorage.getItem("user");return e?JSON.parse(e):null}catch(e){return null}},n=()=>localStorage.getItem("token"),i=()=>!!n(),s=()=>{let e=a();return!!e&&["admin","super_admin","operator"].includes(e.role)},o=e=>["admin","super_admin","operator"].includes(e)?"/admin":"/dashboard",l=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),localStorage.removeItem("isAdmin"),localStorage.removeItem("adminEmail"),window.location.href="/"}},66209:function(e,t,r){r.d(t,{X6:function(){return o},dN:function(){return s},o0:function(){return n},p6:function(){return a}});let a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return"N/A";try{let r=new Date(e);if(isNaN(r.getTime()))return"N/A";let a={day:"2-digit",month:"2-digit",year:"numeric",...t};return r.toLocaleDateString("tr-TR",a)}catch(e){return console.error("Error formatting date:",e),"N/A"}},n=e=>{if(!e)return"N/A";try{let t=new Date(e);if(isNaN(t.getTime()))return"N/A";return t.toLocaleDateString("tr-TR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch(e){return console.error("Error formatting date time:",e),"N/A"}},i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"TRY",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"tr-TR";if(null==e)return i(0,t,r);try{let a="string"==typeof e?parseFloat(e):e;if(isNaN(a))return i(0,t,r);return new Intl.NumberFormat(r,{style:"currency",currency:t,minimumFractionDigits:2,maximumFractionDigits:2}).format(a)}catch(r){return console.error("Error formatting currency:",r),"".concat(e," ").concat(t)}},s=e=>i(e,"TRY","tr-TR"),o=e=>{if(null==e)return"0%";try{let t="string"==typeof e?parseFloat(e):e;if(isNaN(t))return"0%";if(t>0)return"+".concat(t.toFixed(1),"%");if(t<0)return"".concat(t.toFixed(1),"%");return"0%"}catch(e){return console.error("Error formatting change:",e),"0%"}}},24215:function(e,t,r){r.d(t,{cM:function(){return s}});let a={DEBUG:"debug",INFO:"info",WARN:"warn",ERROR:"error"};class n{formatMessage(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=new Date().toISOString(),n="[".concat(a,"] [").concat(e.toUpperCase(),"]");return r?{prefix:n,message:t,data:r}:{prefix:n,message:t}}debug(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!this.isDevelopment)return;let r=this.formatMessage(a.DEBUG,e,t);t?console.log(r.prefix,r.message,r.data):console.log(r.prefix,r.message)}info(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.formatMessage(a.INFO,e,t);t?console.info(r.prefix,r.message,r.data):console.info(r.prefix,r.message)}warn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.formatMessage(a.WARN,e,t);t?console.warn(r.prefix,r.message,r.data):console.warn(r.prefix,r.message)}error(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.formatMessage(a.ERROR,e,t);t?(console.error(r.prefix,r.message,t),this.isDevelopment):console.error(r.prefix,r.message)}apiError(e,t){var r,a,n,i;this.error("API Error [".concat(e,"]"),{endpoint:e,status:null==t?void 0:null===(r=t.response)||void 0===r?void 0:r.status,message:(null==t?void 0:null===(n=t.response)||void 0===n?void 0:null===(a=n.data)||void 0===a?void 0:a.message)||(null==t?void 0:t.message),data:null==t?void 0:null===(i=t.response)||void 0===i?void 0:i.data})}constructor(){this.isDevelopment=!1}}let i=new n,s={debug:(e,t)=>i.debug(e,t),info:(e,t)=>i.info(e,t),warn:(e,t)=>i.warn(e,t),error:(e,t)=>i.error(e,t),apiError:(e,t)=>i.apiError(e,t)}}}]);